==========================================================
Start date : Sun Mar 23 20:34:35 EDT 2025
Job name : pretokenization
Job ID : 3199087
Host : 
==========================================================
attention mode is flash
attention mode is flash
| distributed init (rank 0): env://, gpu 0
| distributed init (rank 1): env://, gpu 1
[20:34:44.947114] job dir: /projectnb/dl4ds/students/alavaee/efficient-cv/scripts/train
[20:34:44.947195] Namespace(batch_size=20,
img_size=256,
data_path='/projectnb/dl4ds/materials/datasets/imagenet/imagenet-train-{000000..000106}.tar',
device='cuda',
seed=0,
num_workers=10,
pin_mem=True,
world_size=2,
local_rank=-1,
dist_on_itp=False,
dist_url='env://',
cached_path='/projectnb/dl4ds/materials/datasets/imagenet-tokenized',
ten_crop=True,
rank=0,
gpu=0,
distributed=True,
dist_backend='nccl')
[rank1]: Traceback (most recent call last):
[rank1]:   File "/projectnb/dl4ds/students/alavaee/efficient-cv/./scripts/train/pretokenization.py", line 275, in <module>
[rank1]:     main(args)
[rank1]:   File "/projectnb/dl4ds/students/alavaee/envs/eff-cv/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank1]:     return func(*args, **kwargs)
[rank1]:   File "/projectnb/dl4ds/students/alavaee/efficient-cv/./scripts/train/pretokenization.py", line 210, in main
[rank1]:     tokenizer = PretrainedTokenizer("maskgit-vqgan-imagenet-f16-256.bin")
[rank1]:   File "/projectnb/dl4ds/students/alavaee/efficient-cv/src/efficient_cv/models/titok.py", line 60, in __init__
[rank1]:     torch.load(pretrained_weight, map_location=torch.device("cpu")), strict=True
[rank1]:   File "/projectnb/dl4ds/students/alavaee/envs/eff-cv/lib/python3.10/site-packages/torch/serialization.py", line 1425, in load
[rank1]:     with _open_file_like(f, "rb") as opened_file:
[rank1]:   File "/projectnb/dl4ds/students/alavaee/envs/eff-cv/lib/python3.10/site-packages/torch/serialization.py", line 751, in _open_file_like
[rank1]:     return _open_file(name_or_buffer, mode)
[rank1]:   File "/projectnb/dl4ds/students/alavaee/envs/eff-cv/lib/python3.10/site-packages/torch/serialization.py", line 732, in __init__
[rank1]:     super().__init__(open(name, mode))
[rank1]: FileNotFoundError: [Errno 2] No such file or directory: 'maskgit-vqgan-imagenet-f16-256.bin'
W0323 20:34:46.405000 1942361 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1942660 closing signal SIGTERM
E0323 20:34:46.569000 1942361 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 1 (pid: 1942661) of binary: /projectnb/dl4ds/students/alavaee/envs/eff-cv/bin/python
Traceback (most recent call last):
  File "/projectnb/dl4ds/students/alavaee/envs/eff-cv/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/projectnb/dl4ds/students/alavaee/envs/eff-cv/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/projectnb/dl4ds/students/alavaee/envs/eff-cv/lib/python3.10/site-packages/torch/distributed/run.py", line 918, in main
    run(args)
  File "/projectnb/dl4ds/students/alavaee/envs/eff-cv/lib/python3.10/site-packages/torch/distributed/run.py", line 909, in run
    elastic_launch(
  File "/projectnb/dl4ds/students/alavaee/envs/eff-cv/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/projectnb/dl4ds/students/alavaee/envs/eff-cv/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
./scripts/train/pretokenization.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-03-23_20:34:46
  host      : scc-503.scc.bu.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1942661)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
